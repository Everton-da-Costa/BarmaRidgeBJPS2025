% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/barma_main.R
\name{barma}
\alias{barma}
\title{Fit Beta Autoregressive Moving Average (βARMA) Models}
\usage{
barma(
  y,
  ar = NA,
  ma = NA,
  link = "logit",
  penalty = 0,
  h1 = 6,
  X = NA,
  X_hat = NA
)
}
\arguments{
\item{y}{A time series object (`ts`) with values in (0, 1).}

\item{ar}{A numeric vector of autoregressive (AR) lags (e.g., `c(1, 2)`).}

\item{ma}{A numeric vector of moving average (MA) lags (e.g., `1`).}

\item{link}{The link function to connect the mean to the linear
predictor. Default is `"logit"`.}

\item{penalty}{A non-negative scalar for the L2 (Ridge) penalty. Set to a
positive value to enable penalized estimation, which is recommended
for addressing numerical instability. Default is `0` (standard MLE).}

\item{h1}{An integer specifying the forecast horizon. Default is `6`.}

\item{X}{An optional matrix of exogenous variables.}

\item{X_hat}{An optional matrix of future exogenous variables, required
for forecasting when `X` is used.}
}
\value{
A list containing the fitted model results:
\item{model}{A summary table of coefficients, standard errors, z-values,
  and p-values.}
\item{coef}{A named vector of all estimated coefficients.}
\item{vcov}{The variance-covariance matrix of the coefficients.}
\item{fitted}{The in-sample fitted mean values (`muhat`).}
\item{forecast}{A vector of out-of-sample forecasted values.}
\item{loglik}{The value of the log-likelihood function at the optimum.}
\item{aic, bic, hq}{Akaike, Bayesian, and Hannan-Quinn information
  criteria.}
\item{conv}{Convergence code from `optim` (`0` indicates success).}
\item{resid2}{Standardized residuals on the predictor scale.}
\item{phi, alpha, varphi, theta, beta}{Individual estimated parameters.}
\item{etahat}{The estimated linear predictor values.}
\item{muhat}{The estimated mean values (same as `fitted`).}
\item{errorhat}{The estimated errors on the predictor scale.}
\item{fisher_info_mat}{The observed Fisher Information Matrix.}
\item{start_values}{Initial values used in the optimization.}
\item{status_inv_inf_matrix}{Indicates if the Fisher matrix was
  invertible (`0` = success, `1` = failure).}
\item{opt}{The raw output object from the `optim` call.}
}
\description{
Fits a comprehensive suite of Beta Autoregressive Moving Average (βARMA)
models for time series valued in (0, 1). Its core feature is the
integration of a Ridge (L2) penalty to provide numerically stable
parameter estimates, addressing common convergence issues. The function
supports both penalized (PMLE) and standard (MLE) estimation.
}
\details{
The estimation of βARMA models can be susceptible to numerical
instability, which may lead to convergence failures or implausible
estimates. To overcome this, this function implements a penalized
maximum likelihood approach using a Ridge (L2) penalty, as introduced
by Cribari-Neto, Costa, & Fonseca (2025).

By adding a penalty term to the log-likelihood, the function's
curvature is improved, leading to more reliable and robust
optimization. Standard MLE, as in Rocha & Cribari-Neto (2009), is
performed when `penalty = 0`.

The model is specified via the `ar`, `ma`, and `X` arguments:
\itemize{
  \item βARMA(p,q): `ar` and `ma` are specified.
  \item βAR(p): Only `ar` is specified.
  \item βMA(q): Only `ma` is specified.
  \item βARMAX, βARX, βMAX: Models with exogenous variables `X`.
}

The optimization is performed using the "BFGS" algorithm via the
`optim` function.

\strong{Implementation Notes:}
This version is a substantial rewrite of the original code by Fabio M.
Bayer. The modifications, implemented by Everton da Costa, include:
\itemize{
  \item A complete rewrite of the code following the tidyverse style guide.
  \item A thorough review against the original article by Rocha &
    Cribari-Neto (2009, with erratum 2017).
  \item Code optimization to avoid redundant computations.
  \item A modular structure to allow functions to be run separately.
}
}
\note{
The original version of this function was developed by Fabio M. Bayer
 (bayer@ufsm.br). Substantially modified and improved by Everton da Costa
 (everton.ecosta@ufpe.br). With suggestions and contributions from
 Rodney Fonceca (rodneyfonseca@ufba.br) and
 Francisco Cribari Neto (francisco.cribari@ufpe.br).
}
\references{
Cribari-Neto, F., Costa, E., & Fonseca, R. V. (2025). Numerical
stability enhancements in beta autoregressive moving average model
estimation. *Brazilian Journal of Probability and Statistics*,
Vol(Issue), pp-pp.

Rocha, A.V., & Cribari-Neto, F. (2009). Beta autoregressive moving
average models. *TEST*, 18(3), 529-545.
<doi:10.1007/s11749-008-0113-2>
}
\author{
Everton da Costa (everton.ecosta@ufpe.br);
Francisco Cribari-Neto (francisco.cribari@ufpe.br);
Rodney V. Fonseca (rodneyfonseca@ufba.br).
}
